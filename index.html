<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="site-version" content="1.0">
  <title>For You</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;1,300;1,400&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    ::selection {
      background: white;
      color: black;
    }

    body {
      font-family: 'Cormorant Garamond', Georgia, serif;
      background: #000;
      color: #fff;
      min-height: 100vh;
      min-height: 100dvh;
      overflow-x: hidden;
    }

    /* Password Screen */
    .password-screen {
      min-height: 100vh;
      min-height: 100dvh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      opacity: 0;
      animation: fadeIn 1.5s ease forwards;
    }

    .password-screen.hidden {
      display: none;
    }

    .subtitle {
      font-size: 0.75rem;
      letter-spacing: 0.4em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.4);
      margin-bottom: 3rem;
    }

    .title {
      font-size: 1.5rem;
      font-weight: 300;
      letter-spacing: 0.2em;
      margin-bottom: 3rem;
      text-align: center;
    }

    .password-input {
      background: transparent;
      border: none;
      border-bottom: 1px solid rgba(255,255,255,0.3);
      color: #fff;
      font-family: inherit;
      font-size: 1.25rem;
      text-align: center;
      padding: 0.75rem;
      width: 200px;
      max-width: 80vw;
      letter-spacing: 0.3em;
      outline: none;
      transition: border-color 0.5s ease;
    }

    .password-input:focus {
      border-color: rgba(255,255,255,0.8);
    }

    .password-input::placeholder {
      color: rgba(255,255,255,0.3);
    }

    .submit-btn {
      background: transparent;
      border: none;
      color: rgba(255,255,255,0.4);
      font-family: inherit;
      font-size: 0.75rem;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      cursor: pointer;
      margin-top: 2.5rem;
      padding: 1rem;
      transition: color 0.5s ease, letter-spacing 0.3s ease;
    }

    .submit-btn:hover {
      color: #fff;
      letter-spacing: 0.4em;
    }

    .hint {
      margin-top: 0.75rem;
      font-size: 0.75rem;
      color: rgba(255,255,255,0.4);
      letter-spacing: 0.15em;
      text-align: center;
      padding: 0 2rem;
      opacity: 0;
      animation: fadeIn 1s ease 1s forwards;
    }

    .error-shake {
      animation: shake 0.4s ease;
    }

    /* Letter Screen */
    .letter-screen {
      min-height: 100vh;
      min-height: 100dvh;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      text-align: center;
    }

    .letter-screen.visible {
      display: flex;
      animation: fadeIn 1.5s ease;
    }

    .sentence {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 0.5rem 0.75rem;
      max-width: 90vw;
      padding: 1rem 0;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.8s ease, transform 0.8s ease;
    }

    .sentence.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .sentence.hidden {
      display: none;
    }

    .word {
      font-size: clamp(1.5rem, 6vw, 2.5rem);
      font-weight: 300;
      opacity: 0;
      transform: translateY(15px);
      transition: opacity 0.6s ease, transform 0.6s ease, letter-spacing 0.3s ease;
      cursor: default;
    }

    .word.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .word:active,
    .word:hover {
      opacity: 0.5;
      letter-spacing: 0.1em;
    }

    .progress-dots {
      display: flex;
      gap: 0.5rem;
      margin-top: 3rem;
      opacity: 0;
      animation: fadeIn 0.5s ease 2s forwards;
    }

    .dot {
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background: rgba(255,255,255,0.2);
      transition: background 0.5s ease, transform 0.3s ease;
    }

    .dot.active {
      background: #fff;
    }

    /* Ending */
    .ending {
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 2rem;
      opacity: 0;
    }

    .ending.visible {
      display: flex;
      animation: fadeIn 1.5s ease forwards;
    }

    .line {
      width: 1px;
      height: 80px;
      background: linear-gradient(to bottom, transparent, rgba(255,255,255,0.5), transparent);
      transform: scaleY(0);
      animation: growLine 1s ease 0.5s forwards;
    }

    .signature {
      font-size: 1.25rem;
      font-style: italic;
      color: rgba(255,255,255,0.6);
      letter-spacing: 0.15em;
      animation: breathe 4s ease-in-out infinite;
    }

    .restart-btn {
      background: transparent;
      border: none;
      color: rgba(255,255,255,0.3);
      font-family: inherit;
      font-size: 0.65rem;
      letter-spacing: 0.25em;
      text-transform: uppercase;
      cursor: pointer;
      padding: 1rem;
      margin-top: 1rem;
      transition: color 0.5s ease, letter-spacing 0.3s ease;
    }

    .restart-btn:hover {
      color: #fff;
      letter-spacing: 0.35em;
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      50% { transform: translateX(10px); }
      75% { transform: translateX(-10px); }
    }

    @keyframes breathe {
      0%, 100% { transform: scale(1); opacity: 0.6; }
      50% { transform: scale(1.02); opacity: 0.8; }
    }

    @keyframes growLine {
      from { transform: scaleY(0); }
      to { transform: scaleY(1); }
    }

    /* Tap highlight removal for mobile */
    * {
      -webkit-tap-highlight-color: transparent;
    }

    /* "Miss me" button + modal */
    .miss-btn {
      display: inline-block;
      margin-top: 1rem;
      background: transparent;
      border: 1px solid rgba(255,255,255,0.06);
      color: rgba(255,255,255,0.85);
      padding: 0.5rem 0.75rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.85rem;
    }

    .message-modal {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1200;
      backdrop-filter: blur(6px);
    }
    .message-modal.visible { display: flex; }
    .message-panel {
      background: rgba(0,0,0,0.92);
      color: #fff;
      border-radius: 8px;
      padding: 1rem;
      width: 92vw;
      max-width: 420px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.6);
      border: 1px solid rgba(255,255,255,0.04);
    }
    .message-panel input[type="text"], .message-panel textarea {
      width: 100%;
      padding: 0.6rem;
      border-radius: 6px;
      border: 1px solid rgba(255,255,255,0.06);
      background: transparent;
      color: #fff;
      resize: vertical;
      margin-bottom: 0.6rem;
    }
    .message-actions { display:flex; gap:0.5rem; justify-content:flex-end; }
    .message-actions button {
      padding: 0.5rem 0.8rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
      letter-spacing: 0.08em;
      transition: background 160ms ease, color 160ms ease, transform 120ms ease;
      border: none;
      background: transparent;
    }

    /* Text-style send and close buttons (same typography) */
    #sendMessageBtn, #closeMessageBtn {
      color: #fff;
      background: transparent;
      border: none;
      padding: 0.5rem 0.8rem;
      font-size: 0.9rem;
      letter-spacing: 0.08em;
      cursor: pointer;
    }
    #sendMessageBtn:hover, #closeMessageBtn:hover {
      color: rgba(255,255,255,0.95);
      transform: translateY(-1px);
    }
  </style>
</head>
<body>

  <!-- Password Screen -->
  <div class="password-screen" id="passwordScreen">
    <p class="subtitle">for you, analy ❤️</p>
    <h1 class="title">enter to read</h1>
    <p class="hint">hint: the endearment you always call me when we talk, the one that always makes me so mad, lol.”</p>
    <form id="passwordForm">
      <input 
        type="password" 
        class="password-input" 
        id="passwordInput"
        placeholder="• • •"
        autocomplete="off"
        autofocus
      >
      <br>
      <button type="submit" class="submit-btn">open</button>
    </form>
    <button id="missBtn" class="miss-btn">Press here if you miss me</button>

    <div id="messageModal" class="message-modal" aria-hidden="true">
      <div class="message-panel" role="dialog" aria-modal="true" aria-labelledby="messageTitle">
        <h3 id="messageTitle" style="margin:0 0 0.5rem 0; font-weight:300; letter-spacing:0.12em;">Send me a message</h3>
        <input id="senderName" type="text" placeholder="Your name (optional)">
        <textarea id="senderMessage" rows="5" placeholder="Write your message..." ></textarea>
        <div class="message-actions">
          <button id="sendMessageBtn">Send</button>
          <button id="closeMessageBtn">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Letter Screen -->
  <div class="letter-screen" id="letterScreen">
    <div id="sentenceContainer"></div>
    <div class="progress-dots" id="progressDots"></div>
    <div class="ending" id="ending">
      <div class="line"></div>
      <p class="signature">— love, gem.</p>
      <button class="restart-btn" id="restartBtn">read again</button>
    </div>
  </div>

  <script src="https://cdn.emailjs.com/sdk/3.2.0/email.min.js"></script>
  <script>
    // Show alert on page open
    window.addEventListener('load', () => {
      alert("Want to talk? Message me. Anytime. Miss you.");
    });

    // --- EmailJS setup ---
    // Replace the placeholders below with your EmailJS Public Key (client-side),
    // Service ID and Template ID. Create a template in EmailJS that accepts
    // at least `message` and `from_name` fields.
    // Note: EmailJS now exposes a Public Key instead of a `user_` id — use that.
    const EMAILJS_PUBLIC_KEY = 'm3vUn90e568dH3eop';
    const EMAILJS_SERVICE_ID = 'service_s20ldrn';
    const EMAILJS_TEMPLATE_ID = 'template_7yx8gdr';

    // Helper to ensure EmailJS SDK is loaded (handles CDN/network issues)
    function ensureEmailJSSDK(timeout = 8000) {
      return new Promise((resolve, reject) => {
        if (window.emailjs) return resolve(window.emailjs);
        // If script tag already present, wait for it
        const existing = document.querySelector('script[src="https://cdn.emailjs.com/sdk/3.2.0/email.min.js"]');
        if (existing) {
          existing.addEventListener('load', () => resolve(window.emailjs));
          existing.addEventListener('error', () => reject(new Error('EmailJS SDK load error')));
        } else {
          const s = document.createElement('script');
          s.src = 'https://cdn.emailjs.com/sdk/3.2.0/email.min.js';
          s.async = true;
          s.onload = () => resolve(window.emailjs);
          s.onerror = () => reject(new Error('EmailJS SDK load error'));
          document.head.appendChild(s);
        }
        // timeout
        setTimeout(() => {
          if (!window.emailjs) reject(new Error('EmailJS SDK load timeout'));
        }, timeout);
      });
    }

    // Try to initialize EmailJS SDK (non-blocking)
    ensureEmailJSSDK().then(() => {
      try {
        if (EMAILJS_PUBLIC_KEY && EMAILJS_PUBLIC_KEY !== 'YOUR_PUBLIC_KEY') {
          emailjs.init(EMAILJS_PUBLIC_KEY);
        }
      } catch (e) {
        console.warn('EmailJS init failed', e);
      }
    }).catch(err => {
      console.warn('EmailJS SDK not available:', err);
    });

    // Configuration
    const PASSWORD = 'dong'; // Change this to your password
    
    const sentences = [
      "Hello. I’m glad you came back to check.",
      "How are you?",
      "I’m writing this because I felt that you didn’t fully believe what I said earlier.",
      "Maybe you just wanted to be sure that when morning comes, I’ll still be the same person you talked to.",
      "The same person who meant every word.",
      "So let me say it clearly, without hesitation.",
      "Yes, it’s true.",
      "I still love you.",
      "I still miss you.",
      "I thought I would be able to completely move on from you, but my heart never learned how.",
      "I’m sorry for what I did, and for the pain I caused.",
      "I hope that one day, you can forgive me.",
      "I won’t drop you again.",
      "I love you.",
      "so bad."
    ];


    // Elements
    const passwordScreen = document.getElementById('passwordScreen');
    const passwordForm = document.getElementById('passwordForm');
    const passwordInput = document.getElementById('passwordInput');
    const letterScreen = document.getElementById('letterScreen');
    const sentenceContainer = document.getElementById('sentenceContainer');
    const progressDots = document.getElementById('progressDots');
    const ending = document.getElementById('ending');
    const restartBtn = document.getElementById('restartBtn');

    let currentSentence = 0;

    // Create progress dots
    sentences.forEach((_, i) => {
      const dot = document.createElement('div');
      dot.className = 'dot';
      progressDots.appendChild(dot);
    });

    // Password handling
    passwordForm.addEventListener('submit', (e) => {
      e.preventDefault();
      if (passwordInput.value.toLowerCase() === PASSWORD.toLowerCase()) {
        passwordScreen.classList.add('hidden');
        letterScreen.classList.add('visible');
        showSentence(0);
      } else {
        passwordInput.classList.add('error-shake');
        setTimeout(() => {
          passwordInput.classList.remove('error-shake');
          passwordInput.value = '';
        }, 400);
      }
    });

    // Show sentence word by word
    function showSentence(index) {
      if (index >= sentences.length) {
        showEnding();
        return;
      }

      currentSentence = index;
      updateDots();

      // Clear previous
      sentenceContainer.innerHTML = '';

      const sentenceDiv = document.createElement('div');
      sentenceDiv.className = 'sentence';
      
      const words = sentences[index].split(' ');
      words.forEach((word, i) => {
        const wordSpan = document.createElement('span');
        wordSpan.className = 'word';
        wordSpan.textContent = word;
        sentenceDiv.appendChild(wordSpan);
      });

      sentenceContainer.appendChild(sentenceDiv);

      // Animate sentence container
      setTimeout(() => sentenceDiv.classList.add('visible'), 100);

      // Animate words one by one
      const wordElements = sentenceDiv.querySelectorAll('.word');
      wordElements.forEach((word, i) => {
        setTimeout(() => {
          word.classList.add('visible');
        }, 300 + (i * 180));
      });

      // Move to next sentence
      const totalTime = 300 + (words.length * 180) + 2500;
      setTimeout(() => {
        sentenceDiv.style.opacity = '0';
        sentenceDiv.style.transform = 'translateY(-10px)';
        setTimeout(() => {
          showSentence(index + 1);
        }, 800);
      }, totalTime);
    }

    function updateDots() {
      const dots = progressDots.querySelectorAll('.dot');
      dots.forEach((dot, i) => {
        if (i <= currentSentence) {
          dot.classList.add('active');
        } else {
          dot.classList.remove('active');
        }
      });
    }

    function showEnding() {
      sentenceContainer.innerHTML = '';
      progressDots.style.display = 'none';
      ending.classList.add('visible');
    }

    // Restart
    restartBtn.addEventListener('click', () => {
      ending.classList.remove('visible');
      progressDots.style.display = 'flex';
      const dots = progressDots.querySelectorAll('.dot');
      dots.forEach(dot => dot.classList.remove('active'));
      setTimeout(() => showSentence(0), 500);
    });

    // --- Message button / modal behavior (EmailJS client send) ---
    const missBtn = document.getElementById('missBtn');
    const messageModal = document.getElementById('messageModal');
    const closeMessageBtn = document.getElementById('closeMessageBtn');
    const sendMessageBtn = document.getElementById('sendMessageBtn');
    const senderName = document.getElementById('senderName');
    const senderMessage = document.getElementById('senderMessage');

    missBtn.addEventListener('click', () => {
      messageModal.classList.add('visible');
      messageModal.setAttribute('aria-hidden', 'false');
      senderMessage.focus();
    });

    closeMessageBtn.addEventListener('click', () => {
      messageModal.classList.remove('visible');
      messageModal.setAttribute('aria-hidden', 'true');
    });

    sendMessageBtn.addEventListener('click', async () => {
      const message = (senderMessage.value || '').trim();
      const name = (senderName.value || '').trim() || 'Anonymous';
      if (!message) { alert('Please write a message.'); senderMessage.focus(); return; }
      // basic cooldown/disable
      sendMessageBtn.disabled = true;
      sendMessageBtn.textContent = 'Sending...';

      try {
        // Simple reliable flow: open the visitor's mail client with a prefilled message.
        // Replace the recipient below with your real email address.
        const recipient = 'otadoygemfelix@gmail.com';
        const subject = encodeURIComponent('Miss you message');
        const body = encodeURIComponent(`From: ${name}\n\n${message}`);
        window.location.href = `mailto:${recipient}?subject=${subject}&body=${body}`;
      
        senderName.value = '';
        senderMessage.value = '';
        messageModal.classList.remove('visible');
        messageModal.setAttribute('aria-hidden', 'true');
      } catch (err) {
        console.error('send error', err);
        alert('Sorry — could not send message.');
      } finally {
        sendMessageBtn.disabled = false;
        sendMessageBtn.textContent = 'Send';
      }
    });
  </script>
</body>
</html>
